<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        #test {
            width: 30%;
            padding-top: 30%;
            border: 1px solid black;
        }
    </style>
</head>

<body>
    <div id="test">
        <input type="text" name="hello" />
        <div class="test">
            <button>你好</button>
            <input type="checkbox" name="hello" id="">
        </div>
        nihao
    </div>
    <script>
        // function virtualize(element) {
        //     // your code here
        //     const res = {}
        //     res.type = element.tagName.toLowerCase()
        //     res.props = {
        //         children: [],
        //         className: element.className
        //     }
        //     Array.from(element.attributes).filter(({
        //         name
        //     }) => name !== 'class').forEach(({
        //         name,
        //         value
        //     }) => {
        //         res.props[name] = value
        //     })
        //     Array.from(element.childNodes).forEach(item => {
        //         item.nodeType === 3 && res.props.children.push(item.textContent)
        //         item.nodeType === 1 && res.props.children.push(virtualize(item))
        //     })
        //     return res
        // }

        // console.log(virtualize(test));

        class EventEmitter {

            constructor() {
                this.events = {}
            }

            subscribe(eventName, callback) {
                if (!this.events[eventName]) {
                    this.events[eventName] = []
                }
                const event = this.events[eventName]
                event.push(callback)
                return {
                    release: () => {
                        this.release(eventName)
                    }
                }
            }

            emit(eventName, ...args) {
                const event = this.events[eventName]
                if (!event) {
                    throw Error('no cb')
                }
                event.forEach(cb => {
                    cb.apply(null, args)
                })
            }

            release(eventName) {
                delete this.events[eventName]
            }
        }

        const emitter = new EventEmitter()

        const sub1 = emitter.subscribe('event1', (...args) => {
            console.log(args);
        })
        const sub2 = emitter.subscribe('event2', (...args) => {
            console.log(args);
        })

        // 同一个callback可以重复订阅同一个事件
        const sub3 = emitter.subscribe('event1', (...args) => {
            console.log(...args);
        })

        emitter.emit('event1', 1, 2);
    </script>
</body>

</html>